/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package com.forum;

import com.forum.database.BaiDangForumDAO;
import java.util.ArrayList;

/**
 *
 * @author 21H1 HNQA
 */
public class PostDetailAndReplyPanelView extends javax.swing.JPanel {
    private int postID; //khi hiển thị thì biết đây là bài đăng nào và nhờ có mã bài đăng này thì khi lưu những phản hồi bài đăng này vào csdl mới được, do có trường MABDFORUM khi thêm vào tabel BINHLUAN
    public int getPostID(){
        return this.postID;
    }
    public void setPostID(int mabaidang){
        this.postID = mabaidang;
    }
    /**
     * Creates new form PostDetailPanel
     */
    public PostDetailAndReplyPanelView(int mabaidang) {
        //initComponents();
        _initComponents(mabaidang);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        tailerPanel = new javax.swing.JPanel();
        nexrButotn = new com.forum.RoundedBorderButton();
        backButton = new com.forum.RoundedBorderButton();
        replyButton = new com.forum.RoundedBorderButton();
        statisticButton = new com.forum.RoundedBorderButton();
        exitButton = new com.forum.RoundedBorderButton();
        scrollPaneWin111 = new com.raven.scroll.ScrollPaneWin11();
        listIncludePostDetailAndReply = new javax.swing.JPanel();

        setBackground(new java.awt.Color(245, 238, 238));

        tailerPanel.setBackground(new java.awt.Color(192, 192, 203));

        nexrButotn.setBackground(new java.awt.Color(172, 172, 172));
        nexrButotn.setForeground(new java.awt.Color(0, 0, 0));
        nexrButotn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-right-26.png"))); // NOI18N
        nexrButotn.setText("Next");
        nexrButotn.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        nexrButotn.setOpaque(true);

        backButton.setBackground(new java.awt.Color(172, 172, 172));
        backButton.setForeground(new java.awt.Color(0, 0, 0));
        backButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-left-26.png"))); // NOI18N
        backButton.setText("Back");
        backButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N

        replyButton.setBackground(new java.awt.Color(172, 172, 172));
        replyButton.setForeground(new java.awt.Color(0, 0, 0));
        replyButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-reply-25.png"))); // NOI18N
        replyButton.setText("Reply");
        replyButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        replyButton.setOpaque(true);

        statisticButton.setBackground(new java.awt.Color(172, 172, 172));
        statisticButton.setForeground(new java.awt.Color(0, 0, 0));
        statisticButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-statistic-25 (1).png"))); // NOI18N
        statisticButton.setText("Statistic");
        statisticButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        statisticButton.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);

        exitButton.setBackground(new java.awt.Color(172, 172, 172));
        exitButton.setForeground(new java.awt.Color(0, 0, 0));
        exitButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-exit-25.png"))); // NOI18N
        exitButton.setText("Exit");
        exitButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        exitButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                exitButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout tailerPanelLayout = new javax.swing.GroupLayout(tailerPanel);
        tailerPanel.setLayout(tailerPanelLayout);
        tailerPanelLayout.setHorizontalGroup(
            tailerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, tailerPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(replyButton, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(statisticButton, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(exitButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(backButton, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(nexrButotn, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        tailerPanelLayout.setVerticalGroup(
            tailerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, tailerPanelLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(tailerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(nexrButotn, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(backButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(replyButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(statisticButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(exitButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        scrollPaneWin111.setBackground(new java.awt.Color(255, 255, 255));
        scrollPaneWin111.setForeground(new java.awt.Color(255, 255, 255));

        listIncludePostDetailAndReply.setBackground(new java.awt.Color(255, 255, 255));

        javax.swing.GroupLayout listIncludePostDetailAndReplyLayout = new javax.swing.GroupLayout(listIncludePostDetailAndReply);
        listIncludePostDetailAndReply.setLayout(listIncludePostDetailAndReplyLayout);
        listIncludePostDetailAndReplyLayout.setHorizontalGroup(
            listIncludePostDetailAndReplyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 953, Short.MAX_VALUE)
        );
        listIncludePostDetailAndReplyLayout.setVerticalGroup(
            listIncludePostDetailAndReplyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 532, Short.MAX_VALUE)
        );

        scrollPaneWin111.setViewportView(listIncludePostDetailAndReply);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(tailerPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addComponent(scrollPaneWin111, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(0, 0, 0))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addComponent(scrollPaneWin111, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(0, 0, 0)
                .addComponent(tailerPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void exitButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_exitButtonActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_exitButtonActionPerformed


    private void _initComponents(int mabaidang) {
        this.listPost = new ArrayList<PostDetailView>();
        this.listPost.add(BaiDangForumDAO.loadDataIntoPostDetailView(mabaidang));
        tailerPanel = new javax.swing.JPanel();
        nexrButotn = new com.forum.RoundedBorderButton();
        backButton = new com.forum.RoundedBorderButton();
        replyButton = new com.forum.RoundedBorderButton();
        statisticButton = new com.forum.RoundedBorderButton();
        exitButton = new com.forum.RoundedBorderButton();
        scrollPaneWin111 = new com.raven.scroll.ScrollPaneWin11();
        listIncludePostDetailAndReply = new javax.swing.JPanel();

        setBackground(new java.awt.Color(245, 238, 238));

        tailerPanel.setBackground(new java.awt.Color(192, 192, 203));

        nexrButotn.setBackground(new java.awt.Color(172, 172, 172));
        nexrButotn.setForeground(new java.awt.Color(0, 0, 0));
        nexrButotn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-right-26.png"))); // NOI18N
        nexrButotn.setText("Next");
        nexrButotn.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        nexrButotn.setOpaque(true);

        backButton.setBackground(new java.awt.Color(172, 172, 172));
        backButton.setForeground(new java.awt.Color(0, 0, 0));
        backButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-left-26.png"))); // NOI18N
        backButton.setText("Back");
        backButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N

        replyButton.setBackground(new java.awt.Color(172, 172, 172));
        replyButton.setForeground(new java.awt.Color(0, 0, 0));
        replyButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-reply-25.png"))); // NOI18N
        replyButton.setText("Reply");
        replyButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        replyButton.setOpaque(true);

        statisticButton.setBackground(new java.awt.Color(172, 172, 172));
        statisticButton.setForeground(new java.awt.Color(0, 0, 0));
        statisticButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-statistic-25 (1).png"))); // NOI18N
        statisticButton.setText("Statistic");
        statisticButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        statisticButton.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);

        exitButton.setBackground(new java.awt.Color(172, 172, 172));
        exitButton.setForeground(new java.awt.Color(0, 0, 0));
        exitButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-exit-25.png"))); // NOI18N
        exitButton.setText("Exit");
        exitButton.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        exitButton.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
                exitButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout tailerPanelLayout = new javax.swing.GroupLayout(tailerPanel);
        tailerPanel.setLayout(tailerPanelLayout);
        tailerPanelLayout.setHorizontalGroup(
            tailerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, tailerPanelLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(replyButton, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(statisticButton, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(exitButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(backButton, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(nexrButotn, javax.swing.GroupLayout.PREFERRED_SIZE, 73, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        tailerPanelLayout.setVerticalGroup(
            tailerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, tailerPanelLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(tailerPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(nexrButotn, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(backButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(replyButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(statisticButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(exitButton, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        scrollPaneWin111.setBackground(new java.awt.Color(255, 255, 255));
        scrollPaneWin111.setForeground(new java.awt.Color(255, 255, 255));

        listIncludePostDetailAndReply.setBackground(new java.awt.Color(255, 255, 255));

        javax.swing.GroupLayout listIncludePostDetailAndReplyLayout = new javax.swing.GroupLayout(listIncludePostDetailAndReply);
        listIncludePostDetailAndReply.setLayout(listIncludePostDetailAndReplyLayout);
        listIncludePostDetailAndReplyLayout.setHorizontalGroup(
            listIncludePostDetailAndReplyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 953, Short.MAX_VALUE)
        );
        listIncludePostDetailAndReplyLayout.setVerticalGroup(
            listIncludePostDetailAndReplyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 532, Short.MAX_VALUE)
        );

        scrollPaneWin111.setViewportView(listIncludePostDetailAndReply);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(tailerPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addComponent(scrollPaneWin111, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(0, 0, 0))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addComponent(scrollPaneWin111, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(0, 0, 0)
                .addComponent(tailerPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
    }// </editor-fold>                        
                                         

    public  void setCurrentPage(int newPage){
        currentPage = newPage;
    }
    public  void setTotalPages(int number){
        totalPages = number;
    }
    public void setListPost(ArrayList<PostDetailView> postList){
        listPost = postList;
    }
    public void updateTotalPages(){
        totalPages = (int) Math.ceil((double) listPost.size() / 20);
    }
    public int getCurrentPage(){
        return currentPage;
    }
    public int getTotalPages(){
        return totalPages;
    }
    public ArrayList<PostDetailView> getListPost(){
        return listPost;
    }
    public void switchPage(int page){
    /*ví dụ: khi người dùng muốn di chuyển đến trang 1 thì dùng hàm switchPage này để thay đổi currentPage, do ta lưu currentPage bắt đầu từ 0
    nên tham số page truyền vào phải trừ đi 1 thì mới đúng bằng giá trị currentPage ta lưu cho trang đó*/
        int mapping = page-1;
        if(mapping != currentPage && mapping >= 0 && mapping < totalPages){
            currentPage = mapping;
        }
    }
    public void setCurrentPageToNext(){
        if(currentPage < getTotalPages()-1){
            currentPage = currentPage+1;
            updateShowPagination();
        }
    }
    public void setCurrentPageToBack(){
        if(currentPage > 0){
            currentPage = currentPage-1;
            updateShowPagination();
        }
    }
    public void loadPostForumFromDatabaseIntoListPost(){
//        setListPost(BaiDangForumDAO.loadAndSortListPostFromDatabase());
//        updateTotalPages(); 
//        updateShowPagination();
    }
    public void updateShowPagination(){
         // Hiển thị các bài đăng khi vào giao diện chính của forum
        int startIndex = currentPage * 20;
        int endIndex = Math.min((currentPage + 1) * 20, listPost.size());
        removeAll(); // Xóa tất cả các panelSub hiện tại khỏi panelMain
        for (int i = startIndex; i < endIndex; i++) {
            add(listPost.get(i)); 
        }
         // Cập nhật giao diện
        revalidate();
        repaint();
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.forum.RoundedBorderButton backButton;
    private com.forum.RoundedBorderButton exitButton;
    private javax.swing.JPanel listIncludePostDetailAndReply;
    private com.forum.RoundedBorderButton nexrButotn;
    private com.forum.RoundedBorderButton replyButton;
    private com.raven.scroll.ScrollPaneWin11 scrollPaneWin111;
    private com.forum.RoundedBorderButton statisticButton;
    private javax.swing.JPanel tailerPanel;
    // End of variables declaration//GEN-END:variables
    private ArrayList<PostDetailView> listPost;
    private int currentPage;
    private int totalPages; 
}
